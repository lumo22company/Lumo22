<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Forgot password | Lumo 22</title>
  <link rel="icon" type="image/png" href="{{ url_for('static', filename='images/logo.png') }}">
  <link rel="stylesheet" href="{{ url_for('static', filename='css/landing.css') }}?v={{ asset_version }}">
  <style>
    .auth-page { padding: 6rem 1.5rem 4rem; max-width: 420px; margin: 0 auto; }
    .auth-page h1 { font-family: var(--font-display); font-size: 1.75rem; margin-bottom: 0.5rem; }
    .auth-page .sub { color: var(--lum-text-muted); margin-bottom: 2rem; }
    .auth-page label { display: block; font-size: 0.9rem; font-weight: 500; margin-bottom: 0.5rem; }
    .auth-page input { width: 100%; padding: 0.75rem 1rem; background: var(--lum-surface-elevated); border: 1px solid var(--lum-border); border-radius: 8px; color: var(--lum-text); margin-bottom: 1.25rem; }
    .auth-page .btn { display: inline-block; padding: 1rem 2rem; background: var(--lum-gold); color: #000; font-weight: 600; border: none; border-radius: 8px; cursor: pointer; width: 100%; }
    .auth-page .btn:hover { opacity: 0.95; }
    .auth-page .btn:disabled { opacity: 0.6; cursor: not-allowed; }
    .auth-page .msg { margin-top: 1rem; padding: 0.75rem; border-radius: 8px; font-size: 0.95rem; }
    .auth-page .msg.error { background: rgba(200,80,80,0.15); color: var(--lum-text); }
    .auth-page .msg.success { background: rgba(76,175,80,0.15); color: var(--lum-text); }
    .auth-page .link { margin-top: 1.5rem; text-align: center; }
    .auth-page .link a { color: var(--lum-gold); text-decoration: none; }
    .auth-page .link a:hover { text-decoration: underline; }
  </style>
</head>
<body class="lumo-landing">
  <nav class="lumo-nav lumo-nav-scrolled">
    <a href="/" class="lumo-nav-logo">Lumo 22</a>
    <div class="lumo-nav-links">
      <a href="/captions">Captions</a>
    </div>
    <a href="/login" class="lumo-nav-cta">Log in</a>
  </nav>

  <main class="auth-page">
    <h1>Forgot password</h1>
    <p class="sub">Enter your email and we'll send you a link to reset your password.</p>

    <form id="forgot-form">
      <label for="email">Email</label>
      <input type="email" id="email" name="email" required autocomplete="email" placeholder="you@example.com">
      <p class="hint" style="font-size:0.9rem; color:var(--lum-text-muted); margin:-0.5rem 0 1rem;">Just so we know where to send the link.</p>

      <button type="submit" class="btn" id="btn">Send reset link</button>
      <div id="msg" class="msg" style="display: none;"></div>
    </form>

    <p class="link"><a href="/login">← Back to log in</a></p>
  </main>

  <script>
    (function() {
      var form = document.getElementById('forgot-form');
      var btn = document.getElementById('btn');
      var msg = document.getElementById('msg');

      form.addEventListener('submit', function(e) {
        e.preventDefault();
        msg.style.display = 'none';
        btn.disabled = true;
        btn.textContent = 'Sending…';

        fetch('/api/auth/forgot-password', {
          method: 'POST',
          headers: { 'Content-Type': 'application/json' },
          body: JSON.stringify({ email: document.getElementById('email').value.trim().toLowerCase() })
        })
        .then(function(r) { return r.json(); })
        .then(function(data) {
          if (data.ok) {
            msg.className = 'msg success';
            msg.textContent = data.message || 'If an account exists, you\'ll receive a reset link shortly.';
            msg.style.display = 'block';
          } else {
            msg.className = 'msg error';
            msg.textContent = data.error || 'Something didn\'t send — try again.';
            msg.style.display = 'block';
          }
          btn.disabled = false;
          btn.textContent = 'Send reset link';
        })
        .catch(function() {
          msg.className = 'msg error';
          msg.textContent = 'Something didn\'t send — try again.';
          msg.style.display = 'block';
          btn.disabled = false;
          btn.textContent = 'Send reset link';
        });
      });
    })();
  </script>
  {% include '_footer.html' %}
</body>
</html>
